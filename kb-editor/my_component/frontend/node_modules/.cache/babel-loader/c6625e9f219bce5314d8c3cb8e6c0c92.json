{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PopupControl = void 0;\n// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\nvar constants_1 = require(\"./constants\");\nvar Utils = require(\"../utils\");\nvar host_config_1 = require(\"../host-config\");\nvar PopupControl = /** @class */function () {\n  function PopupControl() {\n    this._isOpen = false;\n  }\n  PopupControl.prototype.keyDown = function (e) {\n    switch (e.key) {\n      case constants_1.Constants.keys.escape:\n        this.closePopup(true);\n        break;\n    }\n  };\n  PopupControl.prototype.render = function (_rootElementBounds) {\n    var _this = this;\n    var element = document.createElement(\"div\");\n    element.tabIndex = 0;\n    element.className = this.hostConfig.makeCssClassName(\"ac-ctrl\", \"ac-ctrl-popup-container\");\n    element.setAttribute(\"role\", \"dialog\");\n    element.setAttribute(\"aria-modal\", \"true\");\n    element.onkeydown = function (e) {\n      _this.keyDown(e);\n      return !e.cancelBubble;\n    };\n    element.appendChild(this.renderContent());\n    return element;\n  };\n  PopupControl.prototype.focus = function () {\n    if (this._popupElement) {\n      this._popupElement.firstElementChild.focus();\n    }\n  };\n  PopupControl.prototype.popup = function (rootElement) {\n    var _a, _b, _c, _d, _f;\n    var _this = this;\n    if (!this._isOpen) {\n      this._overlayElement = document.createElement(\"div\");\n      this._overlayElement.className = this.hostConfig.makeCssClassName(\"ac-ctrl-overlay\");\n      this._overlayElement.tabIndex = 0;\n      this._overlayElement.style.width = document.documentElement.scrollWidth + \"px\";\n      this._overlayElement.style.height = document.documentElement.scrollHeight + \"px\";\n      this._overlayElement.onfocus = function (_e) {\n        _this.closePopup(true);\n      };\n      document.body.appendChild(this._overlayElement);\n      var rootElementBounds = rootElement.getBoundingClientRect();\n      this._popupElement = this.render(rootElementBounds);\n      (_a = this._popupElement.classList).remove.apply(_a, this.hostConfig.makeCssClassNames(\"ac-ctrl-slide\", \"ac-ctrl-slideLeftToRight\", \"ac-ctrl-slideRightToLeft\", \"ac-ctrl-slideTopToBottom\", \"ac-ctrl-slideRightToLeft\"));\n      window.addEventListener(\"resize\", function (_e) {\n        _this.closePopup(true);\n      });\n      var rootElementLabel = rootElement.getAttribute(\"aria-label\");\n      if (rootElementLabel) {\n        this._popupElement.setAttribute(\"aria-label\", rootElementLabel);\n      }\n      this._overlayElement.appendChild(this._popupElement);\n      var popupElementBounds = this._popupElement.getBoundingClientRect();\n      var availableSpaceBelow = window.innerHeight - rootElementBounds.bottom;\n      var availableSpaceAbove = rootElementBounds.top;\n      var availableSpaceRight = window.innerWidth - rootElementBounds.right;\n      var availableSpaceLeft = rootElementBounds.left;\n      var left = rootElementBounds.left + Utils.getScrollX();\n      var top_1;\n      if (availableSpaceAbove < popupElementBounds.height && availableSpaceBelow < popupElementBounds.height) {\n        // Not enough space above or below root element\n        var actualPopupHeight = Math.min(popupElementBounds.height, window.innerHeight);\n        this._popupElement.style.maxHeight = actualPopupHeight + \"px\";\n        if (actualPopupHeight < popupElementBounds.height) {\n          top_1 = Utils.getScrollY();\n        } else {\n          top_1 = Utils.getScrollY() + rootElementBounds.top + (rootElementBounds.height - actualPopupHeight) / 2;\n        }\n        if (availableSpaceLeft < popupElementBounds.width && availableSpaceRight < popupElementBounds.width) {\n          // Not enough space left or right of root element\n          var actualPopupWidth = Math.min(popupElementBounds.width, window.innerWidth);\n          this._popupElement.style.maxWidth = actualPopupWidth + \"px\";\n          if (actualPopupWidth < popupElementBounds.width) {\n            left = Utils.getScrollX();\n          } else {\n            left = Utils.getScrollX() + rootElementBounds.left + (rootElementBounds.width - actualPopupWidth) / 2;\n          }\n        } else {\n          // Enough space on the left or right of the root element\n          if (availableSpaceRight >= popupElementBounds.width) {\n            left = Utils.getScrollX() + rootElementBounds.right;\n            (_b = this._popupElement.classList).add.apply(_b, this.hostConfig.makeCssClassNames(\"ac-ctrl-slide\", \"ac-ctrl-slideLeftToRight\"));\n          } else {\n            left = Utils.getScrollX() + rootElementBounds.left - popupElementBounds.width;\n            (_c = this._popupElement.classList).add.apply(_c, this.hostConfig.makeCssClassNames(\"ac-ctrl-slide\", \"ac-ctrl-slideRightToLeft\"));\n          }\n        }\n      } else {\n        // Enough space above or below root element\n        if (availableSpaceBelow >= popupElementBounds.height) {\n          top_1 = Utils.getScrollY() + rootElementBounds.bottom;\n          (_d = this._popupElement.classList).add.apply(_d, this.hostConfig.makeCssClassNames(\"ac-ctrl-slide\", \"ac-ctrl-slideTopToBottom\"));\n        } else {\n          top_1 = Utils.getScrollY() + rootElementBounds.top - popupElementBounds.height;\n          (_f = this._popupElement.classList).add.apply(_f, this.hostConfig.makeCssClassNames(\"ac-ctrl-slide\", \"ac-ctrl-slideBottomToTop\"));\n        }\n        if (availableSpaceRight < popupElementBounds.width) {\n          left = Utils.getScrollX() + rootElementBounds.right - popupElementBounds.width;\n        }\n      }\n      this._popupElement.style.left = left + \"px\";\n      this._popupElement.style.top = top_1 + \"px\";\n      this._popupElement.focus();\n      this._isOpen = true;\n    }\n  };\n  PopupControl.prototype.closePopup = function (wasCancelled) {\n    if (this._isOpen) {\n      document.body.removeChild(this._overlayElement);\n      this._isOpen = false;\n      if (this.onClose) {\n        this.onClose(this, wasCancelled);\n      }\n    }\n  };\n  Object.defineProperty(PopupControl.prototype, \"hostConfig\", {\n    get: function () {\n      return this._hostConfig ? this._hostConfig : host_config_1.defaultHostConfig;\n    },\n    set: function (value) {\n      this._hostConfig = value;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(PopupControl.prototype, \"isOpen\", {\n    get: function () {\n      return this._isOpen;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return PopupControl;\n}();\nexports.PopupControl = PopupControl;","map":{"version":3,"mappings":"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","names":["PopupControl","e","key","constants_1","keys","escape","closePopup","_rootElementBounds","element","document","createElement","tabIndex","className","hostConfig","makeCssClassName","setAttribute","onkeydown","_this","keyDown","cancelBubble","appendChild","renderContent","_popupElement","firstElementChild","focus","rootElement","_isOpen","_overlayElement","style","width","documentElement","scrollWidth","height","scrollHeight","onfocus","_e","body","rootElementBounds","getBoundingClientRect","render","classList","remove","makeCssClassNames","window","addEventListener","rootElementLabel","getAttribute","popupElementBounds","availableSpaceBelow","innerHeight","bottom","availableSpaceAbove","top","availableSpaceRight","innerWidth","right","availableSpaceLeft","left","Utils","getScrollX","top_1","actualPopupHeight","Math","min","maxHeight","getScrollY","actualPopupWidth","maxWidth","add","wasCancelled","removeChild","onClose","Object","_hostConfig","host_config_1","value","exports"],"sourceRoot":"","sources":["../../src/controls/popup-control.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}