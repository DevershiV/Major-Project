{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AdaptiveApplet = void 0;\n// Copyright (C) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\nvar Enums = require(\"./enums\");\nvar Utils = require(\"./utils\");\nvar shared_1 = require(\"./shared\");\nvar activity_request_1 = require(\"./activity-request\");\nvar strings_1 = require(\"./strings\");\nvar card_elements_1 = require(\"./card-elements\");\nvar serialization_1 = require(\"./serialization\");\nfunction logEvent(level, message) {\n  var optionalParams = [];\n  for (var _i = 2; _i < arguments.length; _i++) {\n    optionalParams[_i - 2] = arguments[_i];\n  }\n  if (shared_1.GlobalSettings.applets.logEnabled) {\n    if (shared_1.GlobalSettings.applets.onLogEvent) {\n      shared_1.GlobalSettings.applets.onLogEvent(level, message, optionalParams);\n    } else {\n      /* eslint-disable no-console */\n      switch (level) {\n        case Enums.LogLevel.Warning:\n          console.warn(message, optionalParams);\n          break;\n        case Enums.LogLevel.Error:\n          console.error(message, optionalParams);\n          break;\n        default:\n          console.log(message, optionalParams);\n          break;\n      }\n      /* eslint-enable no-console */\n    }\n  }\n}\n\nvar ActivityRequest = /** @class */function () {\n  function ActivityRequest(action, trigger, consecutiveRefreshes) {\n    this.action = action;\n    this.trigger = trigger;\n    this.consecutiveRefreshes = consecutiveRefreshes;\n    this.attemptNumber = 0;\n  }\n  // eslint-disable-next-line @typescript-eslint/require-await\n  ActivityRequest.prototype.retryAsync = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        if (this.onSend) {\n          this.onSend(this);\n        }\n        return [2 /*return*/];\n      });\n    });\n  };\n\n  return ActivityRequest;\n}();\nvar AdaptiveApplet = /** @class */function () {\n  function AdaptiveApplet() {\n    this._allowAutomaticCardUpdate = false;\n    this.renderedElement = document.createElement(\"div\");\n    this.renderedElement.className = \"aaf-cardHost\";\n    this.renderedElement.style.position = \"relative\";\n    this.renderedElement.style.display = \"flex\";\n    this.renderedElement.style.flexDirection = \"column\";\n    this._cardHostElement = document.createElement(\"div\");\n    this._refreshButtonHostElement = document.createElement(\"div\");\n    this._refreshButtonHostElement.className = \"aaf-refreshButtonHost\";\n    this._refreshButtonHostElement.style.display = \"none\";\n    this.renderedElement.appendChild(this._cardHostElement);\n    this.renderedElement.appendChild(this._refreshButtonHostElement);\n  }\n  AdaptiveApplet.prototype.displayCard = function (card) {\n    if (card.renderedElement) {\n      Utils.clearElementChildren(this._cardHostElement);\n      this._refreshButtonHostElement.style.display = \"none\";\n      this._cardHostElement.appendChild(card.renderedElement);\n    } else {\n      throw new Error(\"displayCard: undefined card.\");\n    }\n  };\n  AdaptiveApplet.prototype.showManualRefreshButton = function (refreshAction) {\n    var _this = this;\n    var displayBuiltInManualRefreshButton = this.onShowManualRefreshButton ? this.onShowManualRefreshButton(this) : true;\n    if (displayBuiltInManualRefreshButton) {\n      this._refreshButtonHostElement.style.display = \"none\";\n      var renderedRefreshButton = undefined;\n      if (this.onRenderManualRefreshButton) {\n        renderedRefreshButton = this.onRenderManualRefreshButton(this);\n      } else {\n        var message = strings_1.Strings.runtime.refreshThisCard();\n        if (shared_1.GlobalSettings.applets.refresh.mode === Enums.RefreshMode.Automatic) {\n          var autoRefreshPausedMessage = strings_1.Strings.runtime.automaticRefreshPaused();\n          if (autoRefreshPausedMessage[autoRefreshPausedMessage.length - 1] !== \" \") {\n            autoRefreshPausedMessage += \" \";\n          }\n          message = strings_1.Strings.runtime.clckToRestartAutomaticRefresh();\n        }\n        var cardPayload = {\n          type: \"AdaptiveCard\",\n          version: \"1.2\",\n          body: [{\n            type: \"RichTextBlock\",\n            horizontalAlignment: \"right\",\n            inlines: [{\n              type: \"TextRun\",\n              text: message,\n              selectAction: {\n                type: \"Action.Submit\",\n                id: \"refreshCard\"\n              }\n            }]\n          }]\n        };\n        var card = new card_elements_1.AdaptiveCard();\n        card.parse(cardPayload, new card_elements_1.SerializationContext(serialization_1.Versions.v1_2));\n        card.onExecuteAction = function (action) {\n          if (action.id === \"refreshCard\") {\n            Utils.clearElementChildren(_this._refreshButtonHostElement);\n            _this.internalExecuteAction(refreshAction, activity_request_1.ActivityRequestTrigger.Automatic, 0);\n          }\n        };\n        renderedRefreshButton = card.render();\n      }\n      if (renderedRefreshButton) {\n        Utils.clearElementChildren(this._refreshButtonHostElement);\n        this._refreshButtonHostElement.appendChild(renderedRefreshButton);\n        this._refreshButtonHostElement.style.removeProperty(\"display\");\n      }\n    }\n  };\n  AdaptiveApplet.prototype.createActivityRequest = function (action, trigger, consecutiveRefreshes) {\n    var _this = this;\n    if (this.card) {\n      var request_1 = new ActivityRequest(action, trigger, consecutiveRefreshes);\n      request_1.onSend = function (sender) {\n        sender.attemptNumber++;\n        void _this.internalSendActivityRequestAsync(request_1);\n      };\n      var cancel = this.onPrepareActivityRequest ? !this.onPrepareActivityRequest(this, request_1, action) : false;\n      return cancel ? undefined : request_1;\n    } else {\n      throw new Error(\"createActivityRequest: no card has been set.\");\n    }\n  };\n  AdaptiveApplet.prototype.createMagicCodeInputCard = function (attemptNumber) {\n    var payload = {\n      type: \"AdaptiveCard\",\n      version: \"1.0\",\n      body: [{\n        type: \"TextBlock\",\n        color: \"attention\",\n        text: attemptNumber === 1 ? undefined : \"That didn't work... let's try again.\",\n        wrap: true,\n        horizontalAlignment: \"center\"\n      }, {\n        type: \"TextBlock\",\n        text: 'Please login in the popup. You will obtain a magic code. Paste that code below and select \"Submit\"',\n        wrap: true,\n        horizontalAlignment: \"center\"\n      }, {\n        type: \"Input.Text\",\n        id: \"magicCode\",\n        placeholder: \"Enter magic code\"\n      }, {\n        type: \"ActionSet\",\n        horizontalAlignment: \"center\",\n        actions: [{\n          type: \"Action.Submit\",\n          id: AdaptiveApplet._submitMagicCodeActionId,\n          title: \"Submit\"\n        }, {\n          type: \"Action.Submit\",\n          id: AdaptiveApplet._cancelMagicCodeAuthActionId,\n          title: \"Cancel\"\n        }]\n      }]\n    };\n    var card = new card_elements_1.AdaptiveCard();\n    card.parse(payload);\n    return card;\n  };\n  AdaptiveApplet.prototype.cancelAutomaticRefresh = function () {\n    if (this._allowAutomaticCardUpdate) {\n      logEvent(Enums.LogLevel.Warning, \"Automatic card refresh has been cancelled as a result of the user interacting with the card.\");\n    }\n    this._allowAutomaticCardUpdate = false;\n  };\n  AdaptiveApplet.prototype.createSerializationContext = function () {\n    return this.onCreateSerializationContext ? this.onCreateSerializationContext(this) : new card_elements_1.SerializationContext();\n  };\n  AdaptiveApplet.prototype.internalSetCard = function (payload, consecutiveRefreshes) {\n    var _this = this;\n    if (typeof payload === \"object\" && payload[\"type\"] === \"AdaptiveCard\") {\n      this._cardPayload = payload;\n    }\n    if (this._cardPayload) {\n      try {\n        var card = new card_elements_1.AdaptiveCard();\n        if (this.hostConfig) {\n          card.hostConfig = this.hostConfig;\n        }\n        var serializationContext = this.createSerializationContext();\n        card.parse(this._cardPayload, serializationContext);\n        var doChangeCard = this.onCardChanging ? this.onCardChanging(this, this._cardPayload) : true;\n        if (doChangeCard) {\n          this._card = card;\n          if (this._card.authentication && this._card.authentication.tokenExchangeResource && this.onPrefetchSSOToken) {\n            this.onPrefetchSSOToken(this, this._card.authentication.tokenExchangeResource);\n          }\n          this._card.onExecuteAction = function (action) {\n            // If the user takes an action, cancel any pending automatic refresh\n            _this.cancelAutomaticRefresh();\n            _this.internalExecuteAction(action, activity_request_1.ActivityRequestTrigger.Manual, 0);\n          };\n          this._card.onInputValueChanged = function (_input) {\n            // If the user modifies an input, cancel any pending automatic refresh\n            _this.cancelAutomaticRefresh();\n          };\n          this._card.render();\n          if (this._card.renderedElement) {\n            this.displayCard(this._card);\n            if (this.onCardChanged) {\n              this.onCardChanged(this);\n            }\n            if (this._card.refresh) {\n              if (shared_1.GlobalSettings.applets.refresh.mode === Enums.RefreshMode.Automatic && consecutiveRefreshes < shared_1.GlobalSettings.applets.refresh.maximumConsecutiveAutomaticRefreshes) {\n                if (shared_1.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes <= 0) {\n                  logEvent(Enums.LogLevel.Info, \"Triggering automatic card refresh number \" + (consecutiveRefreshes + 1));\n                  this.internalExecuteAction(this._card.refresh.action, activity_request_1.ActivityRequestTrigger.Automatic, consecutiveRefreshes + 1);\n                } else {\n                  logEvent(Enums.LogLevel.Info, \"Scheduling automatic card refresh number \" + (consecutiveRefreshes + 1) + \" in \" + shared_1.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes + \"ms\");\n                  var action_1 = this._card.refresh.action;\n                  this._allowAutomaticCardUpdate = true;\n                  window.setTimeout(function () {\n                    if (_this._allowAutomaticCardUpdate) {\n                      _this.internalExecuteAction(action_1, activity_request_1.ActivityRequestTrigger.Automatic, consecutiveRefreshes + 1);\n                    }\n                  }, shared_1.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes);\n                }\n              } else if (shared_1.GlobalSettings.applets.refresh.mode !== Enums.RefreshMode.Disabled) {\n                if (consecutiveRefreshes > 0) {\n                  logEvent(Enums.LogLevel.Warning, \"Stopping automatic refreshes after \" + consecutiveRefreshes + \" consecutive refreshes.\");\n                } else {\n                  logEvent(Enums.LogLevel.Warning, \"The card has a refresh section, but automatic refreshes are disabled.\");\n                }\n                if (shared_1.GlobalSettings.applets.refresh.allowManualRefreshesAfterAutomaticRefreshes || shared_1.GlobalSettings.applets.refresh.mode === Enums.RefreshMode.Manual) {\n                  logEvent(Enums.LogLevel.Info, \"Showing manual refresh button.\");\n                  this.showManualRefreshButton(this._card.refresh.action);\n                }\n              }\n            }\n          }\n        }\n      } catch (error) {\n        // Ignore all errors\n        logEvent(Enums.LogLevel.Error, \"setCard: \" + error);\n      }\n    }\n  };\n  AdaptiveApplet.prototype.internalExecuteAction = function (action, trigger, consecutiveRefreshes) {\n    if (action instanceof card_elements_1.ExecuteAction) {\n      if (this.channelAdapter) {\n        var request = this.createActivityRequest(action, trigger, consecutiveRefreshes);\n        if (request) {\n          void request.retryAsync();\n        }\n      } else {\n        throw new Error(\"internalExecuteAction: No channel adapter set.\");\n      }\n    }\n    if (this.onAction) {\n      this.onAction(this, action);\n    }\n  };\n  AdaptiveApplet.prototype.createProgressOverlay = function (request) {\n    if (!this._progressOverlay) {\n      if (this.onCreateProgressOverlay) {\n        this._progressOverlay = this.onCreateProgressOverlay(this, request);\n      } else {\n        this._progressOverlay = document.createElement(\"div\");\n        this._progressOverlay.className = \"aaf-progress-overlay\";\n        var spinner = document.createElement(\"div\");\n        spinner.className = \"aaf-spinner\";\n        spinner.style.width = \"28px\";\n        spinner.style.height = \"28px\";\n        this._progressOverlay.appendChild(spinner);\n      }\n    }\n    return this._progressOverlay;\n  };\n  AdaptiveApplet.prototype.removeProgressOverlay = function (request) {\n    if (this.onRemoveProgressOverlay) {\n      this.onRemoveProgressOverlay(this, request);\n    }\n    if (this._progressOverlay !== undefined) {\n      this.renderedElement.removeChild(this._progressOverlay);\n      this._progressOverlay = undefined;\n    }\n  };\n  AdaptiveApplet.prototype.activityRequestSucceeded = function (response, parsedContent) {\n    if (this.onActivityRequestSucceeded) {\n      this.onActivityRequestSucceeded(this, response, parsedContent);\n    }\n  };\n  AdaptiveApplet.prototype.activityRequestFailed = function (response) {\n    return this.onActivityRequestFailed ? this.onActivityRequestFailed(this, response) : shared_1.GlobalSettings.applets.defaultTimeBetweenRetryAttempts;\n  };\n  AdaptiveApplet.prototype.showAuthCodeInputDialog = function (request) {\n    var _this = this;\n    var showBuiltInAuthCodeInputCard = this.onShowAuthCodeInputDialog ? this.onShowAuthCodeInputDialog(this, request) : true;\n    if (showBuiltInAuthCodeInputCard) {\n      var authCodeInputCard = this.createMagicCodeInputCard(request.attemptNumber);\n      authCodeInputCard.render();\n      authCodeInputCard.onExecuteAction = function (submitMagicCodeAction) {\n        if (_this.card && submitMagicCodeAction instanceof card_elements_1.SubmitAction) {\n          switch (submitMagicCodeAction.id) {\n            case AdaptiveApplet._submitMagicCodeActionId:\n              var authCode = undefined;\n              if (submitMagicCodeAction.data && typeof submitMagicCodeAction.data[\"magicCode\"] === \"string\") {\n                authCode = submitMagicCodeAction.data[\"magicCode\"];\n              }\n              if (authCode) {\n                _this.displayCard(_this.card);\n                request.authCode = authCode;\n                void request.retryAsync();\n              } else {\n                alert(\"Please enter the magic code you received.\");\n              }\n              break;\n            case AdaptiveApplet._cancelMagicCodeAuthActionId:\n              logEvent(Enums.LogLevel.Warning, \"Authentication cancelled by user.\");\n              _this.displayCard(_this.card);\n              break;\n            default:\n              logEvent(Enums.LogLevel.Error, \"Unexpected action taken from magic code input card (id = \" + submitMagicCodeAction.id + \")\");\n              alert(strings_1.Strings.magicCodeInputCard.somethingWentWrong());\n              break;\n          }\n        }\n      };\n      this.displayCard(authCodeInputCard);\n    }\n  };\n  AdaptiveApplet.prototype.internalSendActivityRequestAsync = function (request) {\n    return __awaiter(this, void 0, void 0, function () {\n      var overlay, done, _loop_1, this_1, state_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!this.channelAdapter) {\n              throw new Error(\"internalSendActivityRequestAsync: channelAdapter is not set.\");\n            }\n            overlay = this.createProgressOverlay(request);\n            if (overlay !== undefined) {\n              this.renderedElement.appendChild(overlay);\n            }\n            done = false;\n            _loop_1 = function () {\n              var response, error_1, parsedContent, retryIn_1, attemptOAuth, left, top_1;\n              return __generator(this, function (_b) {\n                switch (_b.label) {\n                  case 0:\n                    response = undefined;\n                    if (request.attemptNumber === 1) {\n                      logEvent(Enums.LogLevel.Info, \"Sending activity request to channel (attempt \" + request.attemptNumber + \")\");\n                    } else {\n                      logEvent(Enums.LogLevel.Info, \"Re-sending activity request to channel (attempt \" + request.attemptNumber + \")\");\n                    }\n                    _b.label = 1;\n                  case 1:\n                    _b.trys.push([1, 3,, 4]);\n                    return [4 /*yield*/, this_1.channelAdapter.sendRequestAsync(request)];\n                  case 2:\n                    response = _b.sent();\n                    return [3 /*break*/, 4];\n                  case 3:\n                    error_1 = _b.sent();\n                    logEvent(Enums.LogLevel.Error, \"Activity request failed: \" + error_1);\n                    this_1.removeProgressOverlay(request);\n                    done = true;\n                    return [3 /*break*/, 4];\n                  case 4:\n                    if (!response) return [3 /*break*/, 10];\n                    if (!(response instanceof activity_request_1.SuccessResponse)) return [3 /*break*/, 5];\n                    this_1.removeProgressOverlay(request);\n                    if (response.rawContent === undefined) {\n                      throw new Error(\"internalSendActivityRequestAsync: Action.Execute result is undefined\");\n                    }\n                    parsedContent = response.rawContent;\n                    try {\n                      parsedContent = JSON.parse(response.rawContent);\n                    } catch (_c) {\n                      // Leave parseContent as is\n                    }\n                    if (typeof parsedContent === \"string\") {\n                      logEvent(Enums.LogLevel.Info, \"The activity request returned a string after \" + request.attemptNumber + \" attempt(s).\");\n                      this_1.activityRequestSucceeded(response, parsedContent);\n                    } else if (typeof parsedContent === \"object\" && parsedContent[\"type\"] === \"AdaptiveCard\") {\n                      logEvent(Enums.LogLevel.Info, \"The activity request returned an Adaptive Card after \" + request.attemptNumber + \" attempt(s).\");\n                      this_1.internalSetCard(parsedContent, request.consecutiveRefreshes);\n                      this_1.activityRequestSucceeded(response, this_1.card);\n                    } else {\n                      throw new Error(\"internalSendActivityRequestAsync: Action.Execute result is of unsupported type (\" + typeof response.rawContent + \")\");\n                    }\n                    done = true;\n                    return [3 /*break*/, 10];\n                  case 5:\n                    if (!(response instanceof activity_request_1.ErrorResponse)) return [3 /*break*/, 9];\n                    retryIn_1 = this_1.activityRequestFailed(response);\n                    if (!(retryIn_1 >= 0 && request.attemptNumber < shared_1.GlobalSettings.applets.maximumRetryAttempts)) return [3 /*break*/, 7];\n                    logEvent(Enums.LogLevel.Warning, \"Activity request failed: \".concat(response.error.message, \". Retrying in \").concat(retryIn_1, \"ms\"));\n                    request.attemptNumber++;\n                    return [4 /*yield*/, new Promise(function (resolve, _reject) {\n                      window.setTimeout(function () {\n                        resolve();\n                      }, retryIn_1);\n                    })];\n                  case 6:\n                    _b.sent();\n                    return [3 /*break*/, 8];\n                  case 7:\n                    logEvent(Enums.LogLevel.Error, \"Activity request failed: \".concat(response.error.message, \". Giving up after \").concat(request.attemptNumber, \" attempt(s)\"));\n                    this_1.removeProgressOverlay(request);\n                    done = true;\n                    _b.label = 8;\n                  case 8:\n                    return [3 /*break*/, 10];\n                  case 9:\n                    if (response instanceof activity_request_1.LoginRequestResponse) {\n                      logEvent(Enums.LogLevel.Info, \"The activity request returned a LoginRequestResponse after \" + request.attemptNumber + \" attempt(s).\");\n                      if (request.attemptNumber <= shared_1.GlobalSettings.applets.maximumRetryAttempts) {\n                        attemptOAuth = true;\n                        if (response.tokenExchangeResource && this_1.onSSOTokenNeeded) {\n                          // Attempt to use SSO. The host will return true if it can handle SSO, in which case\n                          // we bypass OAuth\n                          attemptOAuth = !this_1.onSSOTokenNeeded(this_1, request, response.tokenExchangeResource);\n                        }\n                        if (attemptOAuth) {\n                          // Attempt to use OAuth\n                          this_1.removeProgressOverlay(request);\n                          if (response.signinButton === undefined) {\n                            throw new Error(\"internalSendActivityRequestAsync: the login request doesn't contain a valid signin URL.\");\n                          }\n                          logEvent(Enums.LogLevel.Info, \"Login required at \" + response.signinButton.value);\n                          if (this_1.onShowSigninPrompt) {\n                            // Bypass the built-in auth prompt if the host app handles it\n                            this_1.onShowSigninPrompt(this_1, request, response.signinButton);\n                          } else {\n                            this_1.showAuthCodeInputDialog(request);\n                            left = window.screenX + (window.outerWidth - shared_1.GlobalSettings.applets.authPromptWidth) / 2;\n                            top_1 = window.screenY + (window.outerHeight - shared_1.GlobalSettings.applets.authPromptHeight) / 2;\n                            window.open(response.signinButton.value, response.signinButton.title ? response.signinButton.title : \"Sign in\", \"width=\".concat(shared_1.GlobalSettings.applets.authPromptWidth, \",height=\").concat(shared_1.GlobalSettings.applets.authPromptHeight, \",left=\").concat(left, \",top=\").concat(top_1));\n                          }\n                        }\n                      } else {\n                        logEvent(Enums.LogLevel.Error, \"Authentication failed. Giving up after \" + request.attemptNumber + \" attempt(s)\");\n                        alert(strings_1.Strings.magicCodeInputCard.authenticationFailed());\n                      }\n                      return [2 /*return*/, \"break\"];\n                    } else {\n                      throw new Error(\"Unhandled response type: \" + JSON.stringify(response));\n                    }\n                    _b.label = 10;\n                  case 10:\n                    return [2 /*return*/];\n                }\n              });\n            };\n\n            this_1 = this;\n            _a.label = 1;\n          case 1:\n            if (!!done) return [3 /*break*/, 3];\n            return [5 /*yield**/, _loop_1()];\n          case 2:\n            state_1 = _a.sent();\n            if (state_1 === \"break\") return [3 /*break*/, 3];\n            return [3 /*break*/, 1];\n          case 3:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AdaptiveApplet.prototype.refreshCard = function () {\n    if (this._card && this._card.refresh) {\n      this.internalExecuteAction(this._card.refresh.action, activity_request_1.ActivityRequestTrigger.Manual, 0);\n    }\n  };\n  AdaptiveApplet.prototype.setCard = function (payload) {\n    this.internalSetCard(payload, 0);\n  };\n  Object.defineProperty(AdaptiveApplet.prototype, \"card\", {\n    get: function () {\n      return this._card;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  AdaptiveApplet._submitMagicCodeActionId = \"submitMagicCode\";\n  AdaptiveApplet._cancelMagicCodeAuthActionId = \"cancelMagicCodeAuth\";\n  return AdaptiveApplet;\n}();\nexports.AdaptiveApplet = AdaptiveApplet;","map":{"version":3,"mappings":"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","names":["logEvent","level","message","_i","optionalParams","shared_1","applets","logEnabled","onLogEvent","Enums","LogLevel","Warning","console","warn","Error","error","log","action","trigger","consecutiveRefreshes","ActivityRequest","onSend","renderedElement","document","createElement","className","style","position","display","flexDirection","_cardHostElement","_refreshButtonHostElement","appendChild","AdaptiveApplet","card","Utils","clearElementChildren","refreshAction","displayBuiltInManualRefreshButton","onShowManualRefreshButton","renderedRefreshButton","undefined","onRenderManualRefreshButton","strings_1","runtime","refreshThisCard","refresh","mode","RefreshMode","Automatic","autoRefreshPausedMessage","automaticRefreshPaused","length","clckToRestartAutomaticRefresh","cardPayload","type","version","body","horizontalAlignment","inlines","text","selectAction","id","card_elements_1","parse","serialization_1","v1_2","onExecuteAction","_this","internalExecuteAction","activity_request_1","render","removeProperty","request_1","sender","attemptNumber","internalSendActivityRequestAsync","cancel","onPrepareActivityRequest","payload","color","wrap","placeholder","actions","_submitMagicCodeActionId","title","_cancelMagicCodeAuthActionId","_allowAutomaticCardUpdate","onCreateSerializationContext","_cardPayload","hostConfig","serializationContext","createSerializationContext","doChangeCard","onCardChanging","_card","authentication","tokenExchangeResource","onPrefetchSSOToken","cancelAutomaticRefresh","Manual","onInputValueChanged","_input","displayCard","onCardChanged","maximumConsecutiveAutomaticRefreshes","timeBetweenAutomaticRefreshes","Info","action_1","window","setTimeout","Disabled","allowManualRefreshesAfterAutomaticRefreshes","showManualRefreshButton","channelAdapter","request","createActivityRequest","retryAsync","onAction","_progressOverlay","onCreateProgressOverlay","spinner","width","height","onRemoveProgressOverlay","removeChild","response","parsedContent","onActivityRequestSucceeded","onActivityRequestFailed","defaultTimeBetweenRetryAttempts","showBuiltInAuthCodeInputCard","onShowAuthCodeInputDialog","authCodeInputCard","createMagicCodeInputCard","submitMagicCodeAction","authCode","data","alert","magicCodeInputCard","somethingWentWrong","overlay","createProgressOverlay","done","this_1","sendRequestAsync","_b","error_1","removeProgressOverlay","rawContent","JSON","activityRequestSucceeded","internalSetCard","retryIn_1","activityRequestFailed","maximumRetryAttempts","Promise","resolve","_reject","attemptOAuth","onSSOTokenNeeded","signinButton","value","onShowSigninPrompt","showAuthCodeInputDialog","left","screenX","outerWidth","authPromptWidth","top_1","screenY","outerHeight","authPromptHeight","open","authenticationFailed","stringify","Object","exports"],"sourceRoot":"","sources":["../src/adaptive-applet.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}