{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CardObject = exports.ValidationResults = void 0;\n// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\nvar Enums = require(\"./enums\");\nvar strings_1 = require(\"./strings\");\nvar shared_1 = require(\"./shared\");\nvar host_capabilities_1 = require(\"./host-capabilities\");\nvar serialization_1 = require(\"./serialization\");\nvar ValidationResults = /** @class */function () {\n  function ValidationResults() {\n    this.allIds = {};\n    this.validationEvents = [];\n  }\n  ValidationResults.prototype.addFailure = function (cardObject, event, message) {\n    this.validationEvents.push({\n      phase: Enums.ValidationPhase.Validation,\n      source: cardObject,\n      event: event,\n      message: message\n    });\n  };\n  return ValidationResults;\n}();\nexports.ValidationResults = ValidationResults;\nvar CardObject = /** @class */function (_super) {\n  __extends(CardObject, _super);\n  function CardObject() {\n    //#region Schema\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    //#endregion\n    _this._shouldFallback = false;\n    return _this;\n  }\n  CardObject.prototype.getSchemaKey = function () {\n    return this.getJsonTypeName();\n  };\n  Object.defineProperty(CardObject.prototype, \"requires\", {\n    get: function () {\n      return this.getValue(CardObject.requiresProperty);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Checks if this CardObject contains the given DOM Node.\r\n   * @param node The DOM Node to look for.\r\n   * @returns `true` if the DOM Node was found, `false` otherwise.\r\n   */\n  CardObject.prototype.contains = function (node) {\n    if (this._renderedElement) {\n      return this._renderedElement.contains(node);\n    }\n    return false;\n  };\n  CardObject.prototype.preProcessPropertyValue = function (prop, propertyValue) {\n    var value = propertyValue === undefined ? this.getValue(prop) : propertyValue;\n    if (shared_1.GlobalSettings.allowPreProcessingPropertyValues) {\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      var currentObject = this;\n      while (currentObject && !currentObject.onPreProcessPropertyValue) {\n        currentObject = currentObject.parent;\n      }\n      if (currentObject && currentObject.onPreProcessPropertyValue) {\n        return currentObject.onPreProcessPropertyValue(this, prop, value);\n      }\n    }\n    return value;\n  };\n  CardObject.prototype.setParent = function (value) {\n    this._parent = value;\n  };\n  CardObject.prototype.setShouldFallback = function (value) {\n    this._shouldFallback = value;\n  };\n  CardObject.prototype.shouldFallback = function () {\n    return this._shouldFallback || !this.requires.areAllMet(this.hostConfig.hostCapabilities);\n  };\n  CardObject.prototype.getRootObject = function () {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var currentObject = this;\n    while (currentObject.parent) {\n      currentObject = currentObject.parent;\n    }\n    return currentObject;\n  };\n  CardObject.prototype.internalValidateProperties = function (context) {\n    if (this.id) {\n      if (context.allIds.hasOwnProperty(this.id)) {\n        if (context.allIds[this.id] === 1) {\n          context.addFailure(this, Enums.ValidationEvent.DuplicateId, strings_1.Strings.errors.duplicateId(this.id));\n        }\n        context.allIds[this.id] += 1;\n      } else {\n        context.allIds[this.id] = 1;\n      }\n    }\n  };\n  CardObject.prototype.validateProperties = function () {\n    var result = new ValidationResults();\n    this.internalValidateProperties(result);\n    return result;\n  };\n  /**\r\n   * Recursively searches this CardObject and any children to find the\r\n   * innermost CardObject that owns the given DOM Node.\r\n   *\r\n   * @param node The DOM Node to look for.\r\n   *\r\n   * @returns The owner of the given DOM Node, or `undefined` if no owner was found.\r\n   */\n  CardObject.prototype.findDOMNodeOwner = function (node) {\n    // default implementation for CardObjects with no associated children\n    return this.contains(node) ? this : undefined;\n  };\n  CardObject.prototype.releaseDOMResources = function () {\n    // Do nothing in base implementation\n  };\n  Object.defineProperty(CardObject.prototype, \"parent\", {\n    get: function () {\n      return this._parent;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(CardObject.prototype, \"renderedElement\", {\n    get: function () {\n      return this._renderedElement;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  CardObject.typeNameProperty = new serialization_1.StringProperty(serialization_1.Versions.v1_0, \"type\", undefined, undefined, undefined, function (sender) {\n    return sender.getJsonTypeName();\n  });\n  CardObject.idProperty = new serialization_1.StringProperty(serialization_1.Versions.v1_0, \"id\");\n  CardObject.requiresProperty = new serialization_1.SerializableObjectProperty(serialization_1.Versions.v1_2, \"requires\", host_capabilities_1.HostCapabilities, false, new host_capabilities_1.HostCapabilities());\n  __decorate([(0, serialization_1.property)(CardObject.idProperty)], CardObject.prototype, \"id\", void 0);\n  __decorate([(0, serialization_1.property)(CardObject.requiresProperty)], CardObject.prototype, \"requires\", null);\n  return CardObject;\n}(serialization_1.SerializableObject);\nexports.CardObject = CardObject;","map":{"version":3,"mappings":"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","names":["ValidationResults","cardObject","event","message","validationEvents","push","phase","Enums","ValidationPhase","Validation","source","exports","__extends","_this","CardObject","getJsonTypeName","Object","getValue","requiresProperty","node","_renderedElement","contains","prop","propertyValue","value","undefined","shared_1","allowPreProcessingPropertyValues","currentObject","onPreProcessPropertyValue","parent","_parent","_shouldFallback","requires","areAllMet","hostConfig","hostCapabilities","context","id","allIds","hasOwnProperty","addFailure","ValidationEvent","DuplicateId","strings_1","errors","duplicateId","result","internalValidateProperties","serialization_1","v1_0","sender","v1_2","host_capabilities_1","__decorate","idProperty"],"sourceRoot":"","sources":["../src/card-object.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}