{"ast":null,"code":"\"use strict\";\n\nvar _a;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.clearElementChildren = exports.getScrollY = exports.getScrollX = exports.getFitStatus = exports.truncate = exports.truncateText = exports.stringToCssColor = exports.parseEnum = exports.getEnumValueByName = exports.parseBool = exports.parseNumber = exports.parseString = exports.appendChild = exports.generateUniqueId = exports.isMobileOS = exports.isInternetExplorer = void 0;\n// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\nvar Enums = require(\"./enums\");\nvar Shared = require(\"./shared\");\nfunction isInternetExplorer() {\n  // The documentMode property only exists in IE\n  return window.document.documentMode !== undefined;\n}\nexports.isInternetExplorer = isInternetExplorer;\nfunction isMobileOS() {\n  var userAgent = window.navigator.userAgent;\n  return !!userAgent.match(/Android/i) || !!userAgent.match(/iPad/i) || !!userAgent.match(/iPhone/i);\n}\nexports.isMobileOS = isMobileOS;\n/**\r\n * Generate a UUID prepended with \"__ac-\"\r\n */\nfunction generateUniqueId() {\n  return \"__ac-\" + Shared.UUID.generate();\n}\nexports.generateUniqueId = generateUniqueId;\nfunction appendChild(node, child) {\n  if (child) {\n    node.appendChild(child);\n  }\n}\nexports.appendChild = appendChild;\nfunction parseString(obj, defaultValue) {\n  return typeof obj === \"string\" ? obj : defaultValue;\n}\nexports.parseString = parseString;\nfunction parseNumber(obj, defaultValue) {\n  return typeof obj === \"number\" ? obj : defaultValue;\n}\nexports.parseNumber = parseNumber;\nfunction parseBool(value, defaultValue) {\n  if (typeof value === \"boolean\") {\n    return value;\n  } else if (typeof value === \"string\") {\n    switch (value.toLowerCase()) {\n      case \"true\":\n        return true;\n      case \"false\":\n        return false;\n      default:\n        return defaultValue;\n    }\n  }\n  return defaultValue;\n}\nexports.parseBool = parseBool;\nfunction getEnumValueByName(enumType, name) {\n  // eslint-disable-next-line guard-for-in\n  for (var key in enumType) {\n    var keyAsNumber = parseInt(key, 10);\n    if (keyAsNumber >= 0) {\n      var value = enumType[key];\n      if (value && typeof value === \"string\" && value.toLowerCase() === name.toLowerCase()) {\n        return keyAsNumber;\n      }\n    }\n  }\n  return undefined;\n}\nexports.getEnumValueByName = getEnumValueByName;\nfunction parseEnum(enumType, name, defaultValue) {\n  if (!name) {\n    return defaultValue;\n  }\n  var enumValue = getEnumValueByName(enumType, name);\n  return enumValue !== undefined ? enumValue : defaultValue;\n}\nexports.parseEnum = parseEnum;\nfunction stringToCssColor(color) {\n  if (color) {\n    var regEx = /#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi;\n    var matches = regEx.exec(color);\n    if (matches && matches[4]) {\n      var a = parseInt(matches[1], 16) / 255;\n      var r = parseInt(matches[2], 16);\n      var g = parseInt(matches[3], 16);\n      var b = parseInt(matches[4], 16);\n      return \"rgba(\" + r + \",\" + g + \",\" + b + \",\" + a + \")\";\n    }\n  }\n  return color;\n}\nexports.stringToCssColor = stringToCssColor;\nfunction truncateWorker(element, maxHeight, fullText, truncateAt, lineHeight) {\n  var fits = function () {\n    // Allow a one pixel overflow to account for rounding differences\n    // between browsers\n    return maxHeight - element.scrollHeight >= -1.0;\n  };\n  if (fits()) {\n    return;\n  }\n  var breakableIndices = findBreakableIndices(fullText);\n  var lo = 0;\n  var hi = breakableIndices.length;\n  var bestBreakIdx = 0;\n  // Do a binary search for the longest string that fits\n  while (lo < hi) {\n    var mid = Math.floor((lo + hi) / 2);\n    truncateAt(fullText, breakableIndices[mid]);\n    if (fits()) {\n      bestBreakIdx = breakableIndices[mid];\n      lo = mid + 1;\n    } else {\n      hi = mid;\n    }\n  }\n  truncateAt(fullText, bestBreakIdx);\n  // If we have extra room, try to expand the string letter by letter\n  // (covers the case where we have to break in the middle of a long word)\n  if (lineHeight && maxHeight - element.scrollHeight >= lineHeight - 1.0) {\n    var idx = findNextCharacter(fullText, bestBreakIdx);\n    while (idx < fullText.length) {\n      truncateAt(fullText, idx);\n      if (fits()) {\n        bestBreakIdx = idx;\n        idx = findNextCharacter(fullText, idx);\n      } else {\n        break;\n      }\n    }\n    truncateAt(fullText, bestBreakIdx);\n  }\n}\nfunction truncateText(element, maxHeight, lineHeight) {\n  truncateWorker(element, maxHeight, element.innerText, function (text, idx) {\n    element.innerText = text.substring(0, idx) + \"...\";\n  }, lineHeight);\n}\nexports.truncateText = truncateText;\n/**\r\n * {@link truncate} has been deprecated and is no longer in use internally. This policy passes\r\n * content through as it always has, which is _supposed_ to be dealing with text only (see {@link\r\n * TextBlock.truncateIfSupported}), but had a bug where it might actually pass through an element\r\n * for which innerHTML yielded actual HTML (since fixed).\r\n */\nvar ttDeprecatedPolicy = typeof window === 'undefined' ? undefined : (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy(\"adaptivecards#deprecatedExportedFunctionPolicy\", {\n  createHTML: function (value) {\n    return value;\n  }\n});\n/** @deprecated Use {@link truncateText} instead. */\nfunction truncate(element, maxHeight, lineHeight) {\n  truncateWorker(element, maxHeight, element.innerHTML, function (text, idx) {\n    var _a;\n    var truncatedString = text.substring(0, idx) + \"...\";\n    var truncatedHTML = (_a = ttDeprecatedPolicy === null || ttDeprecatedPolicy === void 0 ? void 0 : ttDeprecatedPolicy.createHTML(truncatedString)) !== null && _a !== void 0 ? _a : truncatedString;\n    element.innerHTML = truncatedHTML;\n  }, lineHeight);\n}\nexports.truncate = truncate;\nfunction findBreakableIndices(html) {\n  var results = [];\n  var idx = findNextCharacter(html, -1);\n  while (idx < html.length) {\n    if (html[idx] === \" \") {\n      results.push(idx);\n    }\n    idx = findNextCharacter(html, idx);\n  }\n  return results;\n}\nfunction findNextCharacter(html, currIdx) {\n  currIdx += 1;\n  // If we found the start of an HTML tag, keep advancing until we get\n  // past it, so we don't end up truncating in the middle of the tag\n  while (currIdx < html.length && html[currIdx] === \"<\") {\n    while (currIdx < html.length && html[currIdx++] !== \">\") {\n      continue;\n    }\n  }\n  return currIdx;\n}\nfunction getFitStatus(element, containerEnd) {\n  var start = element.offsetTop;\n  var end = start + element.clientHeight;\n  if (end <= containerEnd) {\n    return Enums.ContainerFitStatus.FullyInContainer;\n  } else if (start < containerEnd) {\n    return Enums.ContainerFitStatus.Overflowing;\n  } else {\n    return Enums.ContainerFitStatus.FullyOutOfContainer;\n  }\n}\nexports.getFitStatus = getFitStatus;\nfunction getScrollX() {\n  return window.pageXOffset;\n}\nexports.getScrollX = getScrollX;\nfunction getScrollY() {\n  return window.pageYOffset;\n}\nexports.getScrollY = getScrollY;\nfunction clearElementChildren(element) {\n  while (element.firstChild) {\n    element.removeChild(element.firstChild);\n  }\n}\nexports.clearElementChildren = clearElementChildren;","map":{"version":3,"mappings":"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","names":["isInternetExplorer","window","document","documentMode","undefined","exports","isMobileOS","userAgent","navigator","match","generateUniqueId","Shared","UUID","generate","appendChild","node","child","parseString","obj","defaultValue","parseNumber","parseBool","value","toLowerCase","getEnumValueByName","enumType","name","key","keyAsNumber","parseInt","parseEnum","enumValue","stringToCssColor","color","regEx","matches","exec","a","r","g","b","truncateWorker","element","maxHeight","fullText","truncateAt","lineHeight","fits","scrollHeight","breakableIndices","findBreakableIndices","lo","hi","length","bestBreakIdx","mid","Math","floor","idx","findNextCharacter","truncateText","innerText","text","substring","ttDeprecatedPolicy","trustedTypes","createPolicy","createHTML","truncate","innerHTML","truncatedString","truncatedHTML","html","results","push","currIdx","getFitStatus","containerEnd","start","offsetTop","end","clientHeight","Enums","ContainerFitStatus","FullyInContainer","Overflowing","FullyOutOfContainer","getScrollX","pageXOffset","getScrollY","pageYOffset","clearElementChildren","firstChild","removeChild"],"sourceRoot":"","sources":["../src/utils.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}