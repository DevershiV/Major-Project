{"ast":null,"code":"\"use strict\";\n\n// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AdaptiveCard = void 0;\nvar AdaptiveCards = __importStar(require(\"adaptivecards\"));\nvar react_1 = __importStar(require(\"react\"));\nvar PropTypes = __importStar(require(\"prop-types\"));\nvar markdown = __importStar(require(\"markdown-it\"));\nvar propTypes = {\n  /** The card schema.  It must comply with the card schema. [More Info](https://docs.microsoft.com/en-us/adaptive-cards/create/cardschema) */\n  payload: PropTypes.object.isRequired,\n  /** Method that will be invoked anytime a card action is executed. [More Info](https://docs.microsoft.com/en-us/adaptive-cards/display/implementingrenderer#actions) */\n  onExecuteAction: PropTypes.func,\n  /** Method that will be invoked when a Submit action is executed. [More Info](https://docs.microsoft.com/en-us/adaptive-cards/display/implementingrenderer#actionsubmit) */\n  onActionSubmit: PropTypes.func,\n  /** Method that will be invoked when an Open Url action is executed. [More Info](https://docs.microsoft.com/en-us/adaptive-cards/display/implementingrenderer#actionopenurl) */\n  onActionOpenUrl: PropTypes.func,\n  /** Method that will be invoked when a Show Card action is executed. [More Info](https://docs.microsoft.com/en-us/adaptive-cards/display/implementingrenderer#actionshowcard) */\n  onActionShowCard: PropTypes.func,\n  /** Method that will be invoked if an error is thrown while trying to render a card. */\n  onError: PropTypes.func,\n  /** JSX styles that will be applied to the card conatiner */\n  style: PropTypes.object,\n  /** HostConfig. [More Info](https://docs.microsoft.com/en-us/adaptive-cards/rendering-cards/host-config) */\n  hostConfig: PropTypes.object\n};\nvar defaultOpenUrlHandler = function (action) {\n  window.open(action.url, '_blank');\n};\nvar setUpMarkdownIt = function () {\n  if (!AdaptiveCards.AdaptiveCard.onProcessMarkdown) {\n    AdaptiveCards.AdaptiveCard.onProcessMarkdown = function (text, result) {\n      result.outputHtml = new markdown.default().render(text);\n      result.didProcess = true;\n    };\n  }\n};\nsetUpMarkdownIt();\nvar AdaptiveCard = function (_a) {\n  var payload = _a.payload,\n    onExecuteAction = _a.onExecuteAction,\n    onActionSubmit = _a.onActionSubmit,\n    onActionOpenUrl = _a.onActionOpenUrl,\n    onActionShowCard = _a.onActionShowCard,\n    onError = _a.onError,\n    style = _a.style,\n    hostConfig = _a.hostConfig;\n  var _b = (0, react_1.useState)(),\n    error = _b[0],\n    setError = _b[1];\n  var targetRef = (0, react_1.useRef)(null);\n  var cardRef = (0, react_1.useRef)(new AdaptiveCards.AdaptiveCard());\n  var executeAction = (0, react_1.useCallback)(function (a) {\n    var type = a.getJsonTypeName();\n    switch (type) {\n      case AdaptiveCards.OpenUrlAction.JsonTypeName:\n        {\n          if (onActionOpenUrl) {\n            onActionOpenUrl(a);\n          } else {\n            defaultOpenUrlHandler(a);\n          }\n          break;\n        }\n      case AdaptiveCards.ShowCardAction.JsonTypeName:\n        {\n          if (onActionShowCard) {\n            onActionShowCard(a);\n          }\n          break;\n        }\n      case AdaptiveCards.SubmitAction.JsonTypeName:\n        {\n          if (onActionSubmit) {\n            onActionSubmit(a);\n          }\n          break;\n        }\n    }\n    // TODO: Why is there a global action handler when we have specific\n    // handlers for the above cases? Can we simplify to one approach?\n    if (onExecuteAction) {\n      onExecuteAction(a);\n    }\n  }, [onActionOpenUrl, onActionShowCard, onActionSubmit, onExecuteAction]);\n  (0, react_1.useEffect)(function () {\n    cardRef.current.onExecuteAction = executeAction;\n  }, [executeAction]);\n  (0, react_1.useEffect)(function () {\n    cardRef.current.hostConfig = new AdaptiveCards.HostConfig(hostConfig);\n  }, [hostConfig]);\n  (0, react_1.useEffect)(function () {\n    var _a, _b;\n    if (!targetRef.current) {\n      return;\n    }\n    var card = cardRef.current;\n    try {\n      card.parse(payload);\n      var result = card.render();\n      var trustedHtml = typeof window === 'undefined' ? \"\" : (_b = (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.emptyHTML) !== null && _b !== void 0 ? _b : \"\";\n      targetRef.current.innerHTML = trustedHtml;\n      targetRef.current.appendChild(result);\n    } catch (cardRenderError) {\n      if (onError) {\n        onError(cardRenderError);\n        setError(cardRenderError);\n      }\n    }\n  }, [hostConfig, payload, onError]);\n  if (error) {\n    return react_1.default.createElement(\"div\", {\n      style: {\n        color: 'red'\n      }\n    }, error.message);\n  }\n  return react_1.default.createElement(\"div\", {\n    style: style,\n    ref: targetRef\n  });\n};\nexports.AdaptiveCard = AdaptiveCard;\nexports.AdaptiveCard.propTypes = propTypes;","map":{"version":3,"mappings":"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","names":["propTypes","payload","PropTypes","object","isRequired","onExecuteAction","func","onActionSubmit","onActionOpenUrl","onActionShowCard","onError","style","hostConfig","defaultOpenUrlHandler","action","window","open","url","setUpMarkdownIt","AdaptiveCards","AdaptiveCard","onProcessMarkdown","text","result","outputHtml","markdown","default","render","didProcess","_a","error","setError","targetRef","cardRef","executeAction","a","type","getJsonTypeName","OpenUrlAction","JsonTypeName","ShowCardAction","SubmitAction","current","HostConfig","card","parse","trustedHtml","trustedTypes","emptyHTML","innerHTML","appendChild","cardRenderError","react_1","color","message","ref","exports"],"sourceRoot":"","sources":["../src/adaptive-card.tsx"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}